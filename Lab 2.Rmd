---
title: "Part 3 Visualizing and Mapping"
author: "Emmanuel Robi "
date: "GEOG 458"
output: html_document
---
  
```{r Packages, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rjson)
library(RJSONIO)
library(sf)
library(raster)
library(dplyr)
library(spData)
library(tmap)
library(leaflet)
library(mapview)
library(ggplot2)
library(shiny)
```

#Data 
```{r PART3.3, include = TRUE}
ODDATA <- read.csv("wa_rac_S000_JT01_2015.csv")
ODDATA2 <- read.csv("od2015_Tacoma.csv")
block_data <- read.csv("tacoma_blocks2.csv")
track_data <- read.csv("tacoma_tracts2.csv")
WAC <- read.csv("wac2015_Tacoma.csv")

```

#Part 3.2 
```{r PART3.3, include = TRUE}
library(tidyverse)
baseData=read.csv("wa_od_main_JT01_2015.csv")
odData=baseData
#Filter out Tacoma Codes and pretty up the geocodes
odData <- filter(odData, w_geocode > 530530603000000 & w_geocode < 530530620999999 | h_geocode > 530530603000000 & h_geocode < 530530620999999)
odData$w_geocode<-as.character(odData$w_geocode)
odData$h_geocode<-as.character(odData$h_geocode)
odData$w_geocode[which(length(odData$w_geocode) == 14)]<-paste0("0",odData$w_geocode[which(length(odData$w_geocode) == 14)])
odData$h_geocode[which(length(odData$h_geocode) == 14)]<-paste0("0",odData$h_geocode[which(length(odData$h_geocode) == 14)])
#Making Columns for worktract and hometract
odData$wt<-substr(odData$w_geocode,1,11)
odData$ht<-substr(odData$h_geocode,1,11)
odData
#Plots compare Total Numbers of Jobs to Number of jobs in Goods Producing industry sectors and Number of jobs in Trade, Transportation, and Utilities industry sectors
p <-ggplot(data = odData, aes(odData$S000, odData$SI01))
p + geom_bar(stat="identity", aes(fill = odData$SI02)) + xlab("Total Number of Jobs") + ylab("Number of jobs in Goods Producing industry sectors") + labs(fill = "Number of jobs in Trade, Transportation, and Utilities industry sectors")
```



#Part 3.3
```{r PART3.3, include = TRUE}
library(dplyr)
##Cuts lasst four characters in H_geocode for ODDATA2
ODDATA2$h_geocode <- substr(as.character(ODDATA2$h_geocode),
                       start= 1, 
                       stop= nchar(as.character(ODDATA2$h_geocode) )-4 )

##Cuts lasst four characters in H_geocode for ODDATA2
Block_data2 <- block_data
Block_data2$h_geocode <- substr(as.character(Block_data2$h_geocode),
                      start= 1, 
                      stop= nchar(as.character(Block_data2$h_geocode) )-4)    


block_data$h_geocode = block_data$GEOID10
track_data$wt = track_data$GEOID.1
Block_and_OD <- merge(block_data, ODDATA2, by=c("h_geocode"))
Track_and_Wac <- merge(track_data, WAC, by=c("wt"))

###Create Map 1
my.plot <- ggplot(data = Block_and_OD,
                  aes(x = Block_and_OD$INTPTLON10,
                      y = Block_and_OD$INTPTLAT10))

my.plot <- my.plot + geom_point(aes(colour = Block_and_OD$SE01)) + xlab("Long") + ylab("Lat") 
print(my.plot)

##Create Map 2
my.plot2 <- ggplot(data = Track_and_Wac,
                  aes(x = Track_and_Wac$INTPTLON, 
                      y =Track_and_Wac$INTPTLAT))
          
                  
my.plot2 <- my.plot2 + geom_point(aes(colour = Track_and_Wac$CE03)) + xlab("Long") + ylab("Lat") 
print(my.plot2)


```


#Part 3.4
```{r PART3.3, include = TRUE}

###Create Map of OD 

```



